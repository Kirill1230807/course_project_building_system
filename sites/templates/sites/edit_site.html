{% extends "core/layout.html" %}
{% load static %}

{% block title %}Редагування об’єкта{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'pages/sites/edit_site.css' %}">
{% endblock %}

{% block content %}

<h1 class="page-title">Редагування об’єкта будівництва</h1>

<div class="form-wrapper">
<form class="styled-form" method="post" action="{% url 'sites:edit' site.id %}">
    {% csrf_token %}

    <label>Назва:</label>
    <input type="text" name="name" value="{{ site.name }}" required>

    <label>Адреса:</label>
    <input type="text" name="address" value="{{ site.address }}" required>

    <label>Дата початку:</label>
    <input type="date" name="start_date" value="{{ site.start_date|date:'Y-m-d' }}" required>

    <label>Дата завершення:</label>
    <input type="date" name="end_date" value="{{ site.end_date|default_if_none:''|date:'Y-m-d' }}">

    <label>Дедлайн:</label>
    <input type="date" name="deadline" value="{{ site.deadline|date:'Y-m-d' }}">

    <label>Управління:</label>
    <select name="management_id">
        <option value="">— Оберіть управління —</option>
        {% for id, name in managements %}
            <option value="{{ id }}" {% if site.management_id == id %}selected{% endif %}>
                {{ name }}
            </option>
        {% endfor %}
    </select>

    <label>Відповідальний інженер:</label>
    <select name="responsible_engineer_id">
        <option value="">— Оберіть інженера —</option>
        {% for id, name in engineers %}
            <option value="{{ id }}" {% if site.responsible_engineer_id == id %}selected{% endif %}>
                {{ name }}
            </option>
        {% endfor %}
    </select>

    <label>Статус:</label>
    <select name="status" required>
        <option value="Планується" {% if site.status == "Планується" %}selected{% endif %}>Планується</option>
        <option value="В процесі" {% if site.status == "В процесі" %}selected{% endif %}>В процесі</option>
        <option value="Завершено" {% if site.status == "Завершено" %}selected{% endif %}>Завершено</option>
        <option value="Завершено із запізненням"
            {% if site.status == "Завершено із запізненням" %}selected{% endif %}>
            Завершено із запізненням
        </option>
    </select>

    <label>Примітки:</label>
    <textarea name="notes" rows="3">{{ site.notes|default_if_none:'' }}</textarea>

    {% if error_msg %}
        <p class="error-msg">{{ error_msg }}</p>
    {% endif %}

    <button type="submit" class="btn-primary">Зберегти зміни</button>
    <a href="{% url 'sites:index' %}" class="btn-back">Скасувати</a>
</form>
</div>

{% endblock %}
