{% extends "core/layout.html" %}
{% load static %}

{% block title %}{{ brigade.1 }}{% endblock %}

{% block content %}
    <h1>{{ brigade.1 }}</h1>

    <p><strong>Бригадир:</strong> {{ brigade.2|default:"--" }}</p>

    {% if not brigade.2 %}
        <a href="{% url 'brigades:reassign_leader' brigade.0 %}" class="btn btn-warning">
            Призначити нового бригадира
        </a>
    {% else %}
        <a href="{% url 'brigades:reassign_leader' brigade.0 %}" class="btn btn-secondary">
            Змінити бригадира
        </a>
    {% endif %}

    <p><strong>Статус:</strong> {{ brigade.3 }}</p>
    <p><strong>Примітки:</strong> {{ brigade.4|default:"--" }}</p>

    <hr>

    <button id="openAddMember" class="btn-orange" style="margin-bottom: 15px;">
    Додати учасника
</button>

<!-- Модальне вікно -->
<div id="memberModal" class="modal">
    <div class="modal-content">
        <span class="close" id="closeMemberModal">&times;</span>
        <h2>Додати учасника</h2>

        <form method="post" action="{% url 'brigades:add_member' brigade.0 %}">
            {% csrf_token %}

            <label>Працівник:</label>
            <select name="employee_id" required>
                <option value="">-- Оберіть працівника --</option>
                {% for id, name in employees %}
                    <option value="{{ id }}">{{ name }}</option>
                {% endfor %}
            </select>

            <label>Роль:</label>
            <input type="text" name="role" placeholder="Напр., муляр, зварювальник" required>

            <button type="submit">Додати</button>
        </form>
    </div>
</div>

    <hr>

    <h3>Склад бригади</h3>
    <table border="1" cellpadding="6">
        <tr>
            <th>№</th>
            <th>Ім’я</th>
            <th>Категорія</th>
            <th>Роль</th>
            <th>Дії</th>
        </tr>
        {% for m in members %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ m.1 }}</td>
                <td>{{ m.2 }}</td>
                <td>{{ m.3 }}</td>
                <td>
                    <a href="{% url 'brigades:remove_member' brigade.0 m.0 %}"
                       onclick="return confirm('Видалити з бригади?')">Видалити</a>
                </td>
            </tr>
        {% empty %}
            <tr>
                <td colspan="5">Немає учасників</td>
            </tr>
        {% endfor %}
    </table>

    <br>
    <a href="{% url 'brigades:index' %}">Повернутися до списку</a>
    <link rel="stylesheet" href="{% static 'brigades/css/view.css' %}">
    <script src="{% static 'brigades/js/add_member.js' %}"></script>
{% endblock %}
