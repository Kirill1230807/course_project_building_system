{% extends "core/layout.html" %}
{% load static %}
{% block title %}Види робіт{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'pages/works/works.css' %}">
    <link rel="stylesheet" href="{% static 'components/modal.css' %}">
{% endblock %}

{% block content %}
    <div class="page-container">
        <h1 class="page-title">Види робіт</h1>
        {% if current_role in "admin operator" %}
            <button id="openModalBtn" class="btn-main">Додати вид робіт</button>

            <div id="modal" class="modal">
                <div class="modal-content">
                    <span id="closeModalBtn" class="close">&times;</span>
                    <h2 class="modal-title">Новий вид робіт</h2>

                    <form method="post" action="{% url 'works:add' %}" class="styled-form">
                        {% csrf_token %}

                        <label>Назва:</label>
                        <input type="text" name="name" placeholder="Наприклад, Заливка фундаменту" required>

                        <label>Одиниця вимірювання:</label>
                        <select name="unit_id" required>
                            <option value="">— Оберіть одиницю —</option>
                            {% for u in units %}
                                <option value="{{ u.0 }}">{{ u.1 }}</option>
                            {% endfor %}
                        </select>

                        <label>Вартість (грн):</label>
                        <input type="number" step="0.01" name="cost" placeholder="0.00" required>

                        <button type="submit" class="btn-save">Зберегти</button>
                    </form>
                </div>
            </div>
        {% endif %}
        <div class="table-wrapper">
            <table class="styled-table">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Назва</th>
                    <th>Одиниця</th>
                    <th>Вартість (грн)</th>
                    {% if current_role in "admin operator" %}
                    <th>Дії</th>
                    {% endif %}
                </tr>
                </thead>

                <tbody>
                {% for w in work_types %}
                    <tr>
                        <td>{{ w.0 }}</td>
                        <td>{{ w.1 }}</td>
                        <td>{{ w.2 }}</td>
                        <td>{{ w.3 }}</td>
                        {% if current_role in "admin operator" %}
                        <td class="row-actions">
                            <a href="{% url 'works:edit' w.0 %}" class="action-edit">Редагувати</a>
                            <span>|</span>
                            <a href="{% url 'works:delete' w.0 %}" class="action-delete"
                               onclick="return confirm('Видалити цей вид робіт?')">Видалити</a>
                        </td>
                    {% endif %}
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="5" class="empty-row">Немає записів</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <script src="{% static 'works/js/works.js' %}"></script>
{% endblock %}
