{% extends "core/layout.html" %}
{% load static %}
{% block title %}Бригади{% endblock %}

{% block content %}
    <h1>Бригади</h1>

    <!-- Кнопка відкриття модального вікна -->
    <button id="openModalBtn">Додати бригаду</button>

    <!-- Модальне вікно -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span id="closeModalBtn" class="close">&times;</span>
            <h2>Нова бригада</h2>

            <form method="post" action="{% url 'brigades:add' %}">
                {% csrf_token %}

                <label>Назва бригади:</label>
                <input type="text" name="name" required><br>

                <label>Бригадир:</label>
                <select name="leader_id">
                    <option value="">— Оберіть бригадира —</option>
                    {% for id, name in workers %}
                        <option value="{{ id }}">{{ name }}</option>
                    {% endfor %}
                </select><br>

                <label>Статус:</label>
                <select name="status" required>
                    <option value="Активна">Активна</option>
                    <option value="Неактивна">Неактивна</option>
                </select>

                <label>Примітки:</label>
                <input type="text" name="notes" placeholder="Напр., Займається електрикою">


                {% if error_msg %}
                    <p style="color:red;">{{ error_msg }}</p>
                {% endif %}

                <button type="submit">Зберегти</button>
            </form>
        </div>
    </div>

    <hr>

    <!-- Таблиця бригад -->
    <table border="1" cellpadding="6">
        <tr>
            <th>ID</th>
            <th>Назва</th>
            <th>Бригадир</th>
            <th>Статус</th>
            <th>Примітки</th>
            <th>Дії</th>
        </tr>

        {% for b in brigades %}
            <tr>
                <td>{{ b.0 }}</td>
                <td>{{ b.1 }}</td>
                <td>{{ b.2|default:"—" }}</td>
                <td>{{ b.3 }}</td>
                <td>{{ b.4|default:"—" }}</td>
                <td>
                    <a href="{% url 'brigades:delete' b.0 %}" onclick="return confirm('Видалити бригаду?')">Видалити</a>
                    |
                    <a href="{% url 'brigades:view' b.0 %}">Детальніше</a>
                </td>
            </tr>
        {% endfor %}
    </table>

    <link rel="stylesheet" href="{% static 'brigades/css/brigades.css' %}">
    <script src="{% static 'brigades/js/brigades.js' %}"></script>
{% endblock %}
